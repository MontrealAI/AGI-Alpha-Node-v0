# AGI Alpha Node Subgraph schema

type Agent @entity(immutable: false) {
  id: ID!
  totalWorkUnits: BigInt!
  totalAccepted: BigInt!
  totalValidations: BigInt!
  totalSlashAmount: BigInt!
  lastUpdated: Int!
  workUnits: [WorkUnit!]! @derivedFrom(field: "agent")
  dailyMetrics: [AgentDailyMetric!]! @derivedFrom(field: "agent")
  metricWindows: [AgentMetricWindow!]! @derivedFrom(field: "agent")
}

type Node @entity(immutable: false) {
  id: ID!
  totalWorkUnits: BigInt!
  totalAccepted: BigInt!
  totalValidations: BigInt!
  totalSlashAmount: BigInt!
  lastUpdated: Int!
  workUnits: [WorkUnit!]! @derivedFrom(field: "node")
  dailyMetrics: [NodeDailyMetric!]! @derivedFrom(field: "node")
  metricWindows: [NodeMetricWindow!]! @derivedFrom(field: "node")
}

type WorkUnit @entity(immutable: false) {
  id: ID!
  agent: Agent!
  node: Node!
  mintedAt: Int!
  acceptedAt: Int
  lastValidatedAt: Int
  validationCount: BigInt!
  totalScore: BigInt!
  totalStake: BigInt!
}

type AgentDailyMetric @entity(immutable: false) {
  id: ID!
  agent: Agent!
  day: Int!
  mintedCount: BigInt!
  acceptedCount: BigInt!
  validationCount: BigInt!
  scoreSum: BigInt!
  stakeSum: BigInt!
  slashAmount: BigInt!
}

type NodeDailyMetric @entity(immutable: false) {
  id: ID!
  node: Node!
  day: Int!
  mintedCount: BigInt!
  acceptedCount: BigInt!
  validationCount: BigInt!
  scoreSum: BigInt!
  stakeSum: BigInt!
  slashAmount: BigInt!
}

type AgentMetricWindow @entity(immutable: false) {
  id: ID!
  agent: Agent!
  windowDays: Int!
  mintedCount: BigInt!
  acceptedCount: BigInt!
  validationCount: BigInt!
  averageScore: BigDecimal!
  slashAmount: BigInt!
  updatedAt: Int!
}

type NodeMetricWindow @entity(immutable: false) {
  id: ID!
  node: Node!
  windowDays: Int!
  mintedCount: BigInt!
  acceptedCount: BigInt!
  validationCount: BigInt!
  averageScore: BigDecimal!
  slashAmount: BigInt!
  updatedAt: Int!
}

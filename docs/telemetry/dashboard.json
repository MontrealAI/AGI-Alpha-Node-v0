{
  "$schema": "https://agi.alpha/schemas/dashboard/v1.json",
  "version": "1.1.0",
  "title": "AGI Alpha Node KPI Control Plane",
  "description": "Validator-weighted α-WU KPIs with ENS-gated health posture telemetry.",
  "domains": ["slo", "validation", "leaderboard"],
  "tags": ["agi", "alpha-node", "telemetry"],
  "refreshInterval": "30s",
  "timeRange": {
    "from": "now-7d",
    "to": "now"
  },
  "datasources": [
    {
      "name": "prometheus",
      "type": "prometheus",
      "endpoint": "https://prometheus.alpha-node.local/api/v1"
    },
    {
      "name": "alphaSubgraph",
      "type": "subgraph",
      "endpoint": "https://api.thegraph.com/subgraphs/name/agi/alpha-work-units"
    }
  ],
  "widgets": [
    {
      "type": "status",
      "title": "Health Gate",
      "metric": "agi_alpha_node_health_gate_state",
      "mode": "state",
      "labels": { "state": "ready" },
      "thresholds": {
        "warning": 0.5,
        "critical": 0.1
      }
    },
    {
      "type": "timeseries",
      "title": "α-WU Acceptance Rate · 7d",
      "metric": "agi_alpha_node_alpha_wu_acceptance_rate",
      "labels": { "window": "7d" },
      "yAxis": { "unit": "ratio", "min": 0, "max": 1 }
    },
    {
      "type": "timeseries",
      "title": "α-WU Acceptance Rate · 30d",
      "metric": "agi_alpha_node_alpha_wu_acceptance_rate",
      "labels": { "window": "30d" },
      "yAxis": { "unit": "ratio", "min": 0, "max": 1 }
    },
    {
      "type": "timeseries",
      "title": "Validator-Weighted Quality · 7d",
      "metric": "agi_alpha_node_alpha_wu_quality",
      "labels": { "window": "7d" },
      "yAxis": { "unit": "score", "min": 0, "max": 100 }
    },
    {
      "type": "timeseries",
      "title": "Validator-Weighted Quality · 30d",
      "metric": "agi_alpha_node_alpha_wu_quality",
      "labels": { "window": "30d" },
      "yAxis": { "unit": "score", "min": 0, "max": 100 }
    },
    {
      "type": "timeseries",
      "title": "α-WU On-Time p95",
      "metric": "agi_alpha_node_alpha_wu_on_time_p95_seconds",
      "labels": { "window": "7d" },
      "yAxis": { "unit": "seconds", "min": 0 }
    },
    {
      "type": "timeseries",
      "title": "Slash Adjusted Yield",
      "metric": "agi_alpha_node_alpha_wu_slash_adjusted_yield",
      "labels": { "window": "7d" },
      "yAxis": { "unit": "ratio", "min": 0 }
    },
    {
      "type": "table",
      "title": "Slash Adjusted Yield by Node · 7d",
      "metric": "agi_alpha_node_alpha_wu_breakdown",
      "labels": {
        "window": "7d",
        "dimension": "node",
        "metric": "slashingAdjustedYield"
      },
      "columns": [
        { "key": "key", "label": "Node", "format": "hash" },
        { "key": "value", "label": "SAY", "format": "percent" },
        { "key": "accepted", "label": "Accepted", "format": "integer" },
        { "key": "minted", "label": "Minted", "format": "integer" }
      ],
      "sort": { "field": "value", "direction": "desc" }
    },
    {
      "type": "table",
      "title": "Slash Adjusted Yield by Node · 30d",
      "metric": "agi_alpha_node_alpha_wu_breakdown",
      "labels": {
        "window": "30d",
        "dimension": "node",
        "metric": "slashingAdjustedYield"
      },
      "columns": [
        { "key": "key", "label": "Node", "format": "hash" },
        { "key": "value", "label": "SAY", "format": "percent" },
        { "key": "accepted", "label": "Accepted", "format": "integer" },
        { "key": "minted", "label": "Minted", "format": "integer" }
      ],
      "sort": { "field": "value", "direction": "desc" }
    },
    {
      "type": "table",
      "title": "Slash Adjusted Yield by Agent · 7d",
      "metric": "agi_alpha_node_alpha_wu_breakdown",
      "labels": {
        "window": "7d",
        "dimension": "agent",
        "metric": "slashingAdjustedYield"
      },
      "columns": [
        { "key": "key", "label": "Agent", "format": "hash" },
        { "key": "value", "label": "SAY", "format": "percent" },
        { "key": "accepted", "label": "Accepted", "format": "integer" },
        { "key": "minted", "label": "Minted", "format": "integer" }
      ],
      "sort": { "field": "value", "direction": "desc" }
    },
    {
      "type": "table",
      "title": "Slash Adjusted Yield by Agent · 30d",
      "metric": "agi_alpha_node_alpha_wu_breakdown",
      "labels": {
        "window": "30d",
        "dimension": "agent",
        "metric": "slashingAdjustedYield"
      },
      "columns": [
        { "key": "key", "label": "Agent", "format": "hash" },
        { "key": "value", "label": "SAY", "format": "percent" },
        { "key": "accepted", "label": "Accepted", "format": "integer" },
        { "key": "minted", "label": "Minted", "format": "integer" }
      ],
      "sort": { "field": "value", "direction": "desc" }
    },
    {
      "type": "leaderboard",
      "title": "Validation Health Leaders · 24h",
      "datasource": "alphaSubgraph",
      "query": "query ValidationLeaderboard($windowStart: BigInt!) {\n  validators: alphaValidators(first: 10, orderBy: stakeWeightedScore, orderDirection: desc, where: {windowStart_gte: $windowStart}) {\n    id\n    address\n    stakeWeightedScore\n    validations\n    medianLatencySeconds\n  }\n}",
      "columns": [
        { "key": "address", "label": "Validator", "format": "hash" },
        { "key": "stakeWeightedScore", "label": "Stake Weighted Score", "format": "number" },
        { "key": "validations", "label": "Validations", "format": "integer" },
        { "key": "medianLatencySeconds", "label": "Median Latency", "format": "duration" }
      ],
      "rankingField": "stakeWeightedScore",
      "limit": 10,
      "transform": {
        "variables": {
          "windowStart": "{{ nowSubHours(24) }}"
        }
      }
    }
  ]
}

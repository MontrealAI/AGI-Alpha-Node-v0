{
  "$schema": "https://agi.alpha/schemas/dashboard/v1.json",
  "version": "1.1.0",
  "title": "AGI Alpha Node KPI Control Plane",
  "description": "Validator-weighted α-WU KPIs with ENS-gated health posture telemetry.",
  "domains": ["slo", "validation", "leaderboard"],
  "tags": ["agi", "alpha-node", "telemetry"],
  "refreshInterval": "30s",
  "timeRange": {
    "from": "now-7d",
    "to": "now"
  },
  "datasources": [
    {
      "name": "prometheus",
      "type": "prometheus",
      "endpoint": "https://prometheus.alpha-node.local/api/v1"
    },
    {
      "name": "alphaSubgraph",
      "type": "subgraph",
      "endpoint": "https://api.thegraph.com/subgraphs/name/agi/alpha-work-units"
    }
  ],
  "widgets": [
    {
      "type": "status",
      "title": "Health Gate",
      "metric": "agi_alpha_node_health_gate_state",
      "mode": "state",
      "labels": { "state": "ready" },
      "thresholds": {
        "warning": 0.5,
        "critical": 0.1
      }
    },
    {
      "type": "timeseries",
      "title": "α-WU Acceptance Rate · 7d",
      "metric": "agi_alpha_node_alpha_wu_acceptance_rate",
      "labels": { "window": "7d" },
      "yAxis": { "unit": "ratio", "min": 0, "max": 1 }
    },
    {
      "type": "timeseries",
      "title": "α-WU Acceptance Rate · 30d",
      "metric": "agi_alpha_node_alpha_wu_acceptance_rate",
      "labels": { "window": "30d" },
      "yAxis": { "unit": "ratio", "min": 0, "max": 1 }
    },
    {
      "type": "timeseries",
      "title": "Validator-Weighted Quality · 7d",
      "metric": "agi_alpha_node_alpha_wu_quality_score",
      "labels": { "window": "7d" },
      "yAxis": { "unit": "score", "min": 0, "max": 100 }
    },
    {
      "type": "timeseries",
      "title": "Validator-Weighted Quality · 30d",
      "metric": "agi_alpha_node_alpha_wu_quality_score",
      "labels": { "window": "30d" },
      "yAxis": { "unit": "score", "min": 0, "max": 100 }
    },
    {
      "type": "timeseries",
      "title": "α-WU On-Time p95",
      "metric": "agi_alpha_node_alpha_wu_on_time_p95_seconds",
      "labels": { "window": "7d" },
      "yAxis": { "unit": "seconds", "min": 0 }
    },
    {
      "type": "timeseries",
      "title": "Slash Adjusted Yield",
      "metric": "agi_alpha_node_alpha_wu_slash_adjusted_yield",
      "labels": { "window": "7d" },
      "yAxis": { "unit": "ratio", "min": 0 }
    },
    {
      "type": "table",
      "title": "Slash Adjusted Yield · Top Nodes (30d)",
      "datasource": "alphaSubgraph",
      "query": "query NodeYield($windowSeconds: BigInt!) {\n  metrics: alphaWorkAggregates(first: 10, orderBy: slashingAdjustedYield, orderDirection: desc, where: {entity: NODE, windowSeconds: $windowSeconds}) {\n    entityId\n    mintedCount\n    acceptedCount\n    slashingAdjustedYield\n  }\n}",
      "transform": {
        "variables": { "windowSeconds": "2592000" }
      },
      "columns": [
        { "key": "entityId", "label": "Node", "format": "hash" },
        { "key": "slashingAdjustedYield", "label": "SAY", "format": "percent" },
        { "key": "acceptedCount", "label": "Accepted", "format": "integer" },
        { "key": "mintedCount", "label": "Minted", "format": "integer" }
      ],
      "sort": { "field": "slashingAdjustedYield", "direction": "desc" }
    },
    {
      "type": "table",
      "title": "Acceptance Rate · Agents (7d)",
      "datasource": "alphaSubgraph",
      "query": "query AgentAcceptance($windowSeconds: BigInt!) {\n  metrics: alphaWorkAggregates(first: 10, orderBy: acceptanceRate, orderDirection: desc, where: {entity: AGENT, windowSeconds: $windowSeconds}) {\n    entityId\n    acceptanceRate\n    mintedCount\n    acceptedCount\n    slashingAdjustedYield\n  }\n}",
      "transform": {
        "variables": { "windowSeconds": "604800" }
      },
      "columns": [
        { "key": "entityId", "label": "Agent", "format": "hash" },
        { "key": "acceptanceRate", "label": "Acceptance", "format": "percent" },
        { "key": "acceptedCount", "label": "Accepted", "format": "integer" },
        { "key": "mintedCount", "label": "Minted", "format": "integer" },
        { "key": "slashingAdjustedYield", "label": "SAY", "format": "percent" }
      ],
      "sort": { "field": "acceptanceRate", "direction": "desc" }
    },
    {
      "type": "leaderboard",
      "title": "Validation Health Leaders",
      "datasource": "alphaSubgraph",
      "query": "query ValidatorQuality($windowSeconds: BigInt!) {\n  metrics: alphaWorkAggregates(first: 10, orderBy: validatorWeightedQuality, orderDirection: desc, where: {entity: VALIDATOR, windowSeconds: $windowSeconds}) {\n    entityId\n    validatorWeightedQuality\n    acceptanceRate\n    onTimeP95Seconds\n    validationCount\n  }\n}",
      "transform": {
        "variables": { "windowSeconds": "604800" }
      },
      "columns": [
        { "key": "entityId", "label": "Validator", "format": "hash" },
        { "key": "validatorWeightedQuality", "label": "Quality", "format": "number" },
        { "key": "acceptanceRate", "label": "Acceptance", "format": "percent" },
        { "key": "onTimeP95Seconds", "label": "p95", "format": "duration" },
        { "key": "validationCount", "label": "Validations", "format": "integer" }
      ],
      "rankingField": "validatorWeightedQuality",
      "limit": 10
    }
  ]
}
